# python

A collection of Python scripts for handling various data files.

## Epigen[etic|omic]

`methTable.py`. More often than not you want to categorize loci based on their methylation enrichment. `methTable.py` will do just this. As input `methTable.py` requires a file generated from the [bedtools](https://bedtools.readthedocs.io/en/latest/) intersection of an allc file (a vcf-like file generated from [methylpy](https://github.com/yupenghe/methylpy)) and a bed file of loci chromosomal coordinates and identifier (i.e., four columns: chromosome, start, end, identifier):

```bash
#allc file requires the vcf header for bedtools to recognize it
sed -i '1s/^/##fileformat=VCFv4.2\n/' <allc file>
#intersection
bedtools intersect \
-a <allc file> \
-b <bed file> \
-wa \
-wb \
> <intersection outfile>
```

Other required inputs are a taxonomic group for sequence contexts to parse (`animal`: CG and CH, or `plant`: CG, CHG, and CHH), the minumum number of sequence context sites per locus, minumum coverage of sequence context per locus, _Q_ value threshold, and the name of an `outfile`. The statistical enrichment test with False Discovery Rate (FDR) correction performed for each locus follows a very similar method to that described in [Takuno and Gaut (2012)](https://www.ncbi.nlm.nih.gov/pubmed/21813466).

Usage:

```bash
python methTable.py \
--infile=<allc-bed intersect> \
--taxa=<animal|plant> \
--sites=<int> \
--coverage=<int> \
--qvalue=<float> \
--outfile=<outfile>
```

`perSiteMeth.py`. The per-site DNA methylation level is the distribution of DNA methylation levels at individual methylated sites and indicates within a population of cells, the proportion that are methylated. `perSiteMeth.py` will parse an allc file generated by `methylpy` and calculate weighted methylation [Schultz et al. 2012](https://www.ncbi.nlm.nih.gov/pubmed/23131467) for each methylated cytosine of a sequence context specified by taxonomic group (animal or plant). Weighted methylation, along with chromosome, position and strand, will be written to separate files specified by sequence context.

Usage:

```bash
python perSiteMeth.py --infile=<allc file> --coverage=<int> --taxa=<animal|plant>
```

`metaplot.py`. Using an allc file generated by `methylpy` and a General Feature Format (GFF) file (along with some user specified parameters), this script will generate a tab separated file of weighted methylation levels per window along and flanking a genomic feature. The outfile is used to generate what is commonly referred to as a "metaplot". A couple warnings you might encounter with this script:

```
WARNING: Interval Chr#:i-j is smaller than the number of windows requested. Skipping.
```

and

```
FutureWarning: read_table is deprecated, use read_csv instead, passing sep='\t'.
```

No need to worry about these. The first warning is because the flanking region specified runs off the contig/scaffold/chromosome. The second warning is most likely because [pybedtools](https://daler.github.io/pybedtools/) has not updated the [pandas](https://pandas.pydata.org/) function `read_table` to `read_csv`.

Usage:

```
python metaplot.py \
--allc=<filename> \
--gff=<filename \
--taxa=<animal|plant> \
--genome=<filename> \
--feature=<str> \
--flanking=<int> \
--windows=<int> \
--outfile=<outfile>
```

## Gen[etic|omic]

`alignmentConverstion.py`. Converts a multi-sequence alignment (MSA) file of one format to a different format (e.g., fasta to phyip).

Usage:

```bash
python alignmentConversion.py \
--infile=<msa> \
--in_format=<format e.g., fasta> \
--outfile=<output filename> \
--out_format=<format e.g., phylip-relaxed>
```

`extractSeqFromFasta.py`. A very straightforward script to extract a set of sequence(s) from a fasta file based on id.

Usage:

```bash
python extractSeqFromFasta.py \
--ids=<list of ids> \
--fasta=<in fasta file> \
--outfile=<out fasta file>
```

`motifSearch.py`. Searches for motif sequence and reverse complement of motif from a fasta file in a fasta file and records first and last base pair positions.

Usage:

```bash
python motifSearch.py \
--motif=<motif fasta> \
--search=<fasta to search> \
--outfile=<outfile (bed format)>
```
